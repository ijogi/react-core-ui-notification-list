'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.NotificationListItemPreview=exports.NotificationListItem=exports.NotificationList=void 0;var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_react=require('react'),_react2=_interopRequireDefault(_react),_reactRouterDom=require('react-router-dom'),_propTypes=require('prop-types'),_propTypes2=_interopRequireDefault(_propTypes),_reactstrap=require('reactstrap');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var NotificationList=exports.NotificationList=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));_initialiseProps.call(c);var d=c.props,e=d.defaultSortBy,f=d.items;return c.state={sortBy:e||'date',sortDesc:!1,filteredItems:f,isSortingDropdownOpen:!1,isFilteringDropdownOpen:!1,successMessage:null,errorMessage:null},c}return _inherits(b,a),_createClass(b,[{key:'compare',value:function h(c,a,b,d){var e=null,f=null;this.state.sortDesc?(e=d?a[b][d]:a[b],f=d?c[b][d]:c[b]):(e=d?c[b][d]:c[b],f=d?a[b][d]:a[b]);var g=0;return e>f?g=1:e<f&&(g=-1),g}},{key:'handleClick',value:function d(a,b,c){return a(b[c])}},{key:'renderActions',value:function c(a){var b=this;if(a)return _react2.default.createElement('div',null,a.map(function(a){return _react2.default.createElement(_reactstrap.Button,{key:a.icon,color:a.color,onClick:function c(){return b.handleAction(a.func)}},_react2.default.createElement('i',{className:a.icon}),' ',a.name)}))}},{key:'renderButtonDropdown',value:function h(a,b,c,d,f){var g=this,e=this.state[a];return _react2.default.createElement(_reactstrap.ButtonDropdown,{isOpen:e,toggle:function b(){return g.toggle(a)}},_react2.default.createElement(_reactstrap.DropdownToggle,{caret:!0},f),_react2.default.createElement(_reactstrap.DropdownMenu,null,b.map(function(a){return _react2.default.createElement(_reactstrap.DropdownItem,{onClick:function b(){return g.handleClick(c,a,d)},key:a.title},f,' ',a.title)})))}},{key:'renderTableItems',value:function k(){var c=this,a=this.props,b=a.sortableFields,d=a.emptyPage,e=a.priorityClasses,f=a.truncateTextLength,g=this.state,h=g.filteredItems,i=g.sortBy,j=b.find(function(a){return a.title===i});return h&&0<h.length?_react2.default.createElement('ul',{className:'messages'},h.sort(function(d,a){return c.compare(a,d,i,j?j.sortByProp:null)}).map(function(a){return _react2.default.createElement(NotificationListItem,{item:Object.assign({},a),priorityClasses:e,truncateTextLength:f,key:a.id})})):_react2.default.createElement('div',null,d)}},{key:'render',value:function j(){var a=this.state,b=a.successMessage,c=a.errorMessage,d=this.props,e=d.icon,f=d.title,g=d.actions,h=d.sortableFields,i=d.filters;return _react2.default.createElement(_reactstrap.Card,null,_react2.default.createElement(_reactstrap.CardHeader,null,e&&_react2.default.createElement('i',{className:e}),' ',f),_react2.default.createElement(_reactstrap.CardBody,null,_react2.default.createElement(_reactstrap.CardTitle,null,this.renderButtonDropdown('isSortingDropdownOpen',h,this.handleSort,'title','Sort by'),this.renderButtonDropdown('isFilteringDropdownOpen',i,this.handleFilter,'predicateFunc','Show'),_react2.default.createElement(_reactstrap.ButtonGroup,null,this.renderActions(g))),b&&_react2.default.createElement(_reactstrap.Alert,{color:'success animated fadeIn'},b),c&&_react2.default.createElement(_reactstrap.Alert,{color:'danger animated fadeIn'},c),_react2.default.createElement('div',{className:'animated fadeIn'},_react2.default.createElement('div',{className:'email-app mb-4',style:{border:'none'}},_react2.default.createElement('main',{className:'inbox'},this.renderTableItems())))))}}]),b}(_react.PureComponent),_initialiseProps=function(){var a=this;this.toggle=function(b){var c=a.state[b];a.setState(_defineProperty({},b,!c))},this.handleAction=function(b){var c=b();c&&c.isSuccess?(a.setState({successMessage:c&&c.message?c.message:'Done!'}),setTimeout(function(){return a.setState({successMessage:null})},3e3)):(a.setState({errorMessage:c&&c.message?c.message:'Something went wrong...'}),setTimeout(function(){return a.setState({errorMessage:null})},3e3))},this.handleSort=function(b){var c=a.state.sortDesc;a.setState({sortBy:b,sortDesc:!c})},this.handleFilter=function(b){var c=a.props.items;a.setState({filteredItems:c.filter(b)})}};NotificationList.propTypes={title:_propTypes2.default.string.isRequired,icon:_propTypes2.default.string,items:_propTypes2.default.array.isRequired,priorityClasses:_propTypes2.default.instanceOf(Map),sortableFields:_propTypes2.default.array,actions:_propTypes2.default.array,filters:_propTypes2.default.array};var NotificationListItem=exports.NotificationListItem=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.expandText=function(){var a=c.state.showFullText;c.setState({showFullText:!a})},c.handleAction=function(a,b){var d=a(b);d&&d.isSuccess?(c.setState({successMessage:d&&d.message?d.message:'Done!'}),setTimeout(function(){return c.setState({successMessage:null})},3e3)):(c.setState({errorMessage:d&&d.message?d.message:'Something went wrong...'}),setTimeout(function(){return c.setState({errorMessage:null})},3e3))},c.state={showFullText:!1,successMessage:null,errorMessage:null},c}return _inherits(b,a),_createClass(b,[{key:'truncateText',value:function d(a,b){var c=this.state.showFullText;return a.length>b&&!c?a.substring(0,b)+'...':a}},{key:'renderActions',value:function c(a){var b=this;if(a.type&&a.type.actions)return _react2.default.createElement('div',null,a.type.actions.map(function(c){return _react2.default.createElement(_reactstrap.Button,{key:c.icon,color:c.color,onClick:function d(){return b.handleAction(c.func,a)}},_react2.default.createElement('i',{className:c.icon}),' ',c.name)}))}},{key:'renderListItem',value:function d(a,b,c){return _react2.default.createElement('div',null,_react2.default.createElement(_reactstrap.CardHeader,{style:{padding:'0.3rem 0.7rem',borderBottom:'none'},className:a.category?a.category.cssClass:''},_react2.default.createElement('div',{className:'header',style:{margin:'0'}},_react2.default.createElement('span',{className:'from'},b&&_react2.default.createElement('h6',null,_react2.default.createElement(_reactstrap.Badge,{color:b.get(a.priority.name)},a.priority.name),_react2.default.createElement('span',{className:'title'},' ',a.title)),a.alert&&_react2.default.createElement(_reactstrap.Alert,{color:a.alert.color,style:{padding:'0.2rem 0.3rem'}},a.alert.text)))),_react2.default.createElement(_reactstrap.CardBody,{style:{padding:'0.5rem'}},_react2.default.createElement(_reactstrap.CardText,null,_react2.default.createElement('h6',null,a.category?a.category.name:''),_react2.default.createElement(_reactstrap.Media,null,a.sender&&a.sender.avatarUrl&&_react2.default.createElement(_reactstrap.Media,null,_react2.default.createElement(_reactstrap.Media,{object:!0,src:a.sender.avatarUrl,alt:'Client avatar',className:'img-avatar',style:{height:'3.5rem'}})),_react2.default.createElement(_reactstrap.Media,{body:!0},_react2.default.createElement('div',{className:'title',style:a.sender&&a.sender.avatarUrl&&{margin:'0 0.5rem'}},a.sender&&a.sender&&_react2.default.createElement('span',{className:'title'},' ',a.sender.firstName,' ',a.sender.lastName),_react2.default.createElement('span',{className:'description date',style:{float:'right'}},_react2.default.createElement('span',{className:'fa fa-paper-clip'}),a.date.displayDate)),_react2.default.createElement('p',{style:a.sender&&a.sender.avatarUrl&&{margin:'0 0.5rem'}},a.text.length>c?this.truncateText(a.text,c):a.text))))))}},{key:'render',value:function i(){var a=this.state,b=a.successMessage,c=a.errorMessage,d=a.showFullText,e=this.props,f=e.item,g=e.priorityClasses,h=e.truncateTextLength;return _react2.default.createElement('li',{className:(f.category&&f.category.cssClass?f.category.cssClass:'x')&&(f.isRead?'message unread':'message'),style:{cursor:'default',padding:'0'}},_react2.default.createElement(_reactstrap.Card,{style:{border:'none'}},f.url&&_react2.default.createElement(_reactRouterDom.Link,{to:f.url},this.renderListItem(f,g,h)),!f.url&&this.renderListItem(f,g,h),f.text.length>h&&_react2.default.createElement('div',null,_react2.default.createElement(_reactstrap.Button,{color:'link',size:'sm',onClick:this.expandText},d?'Less':'More')),_react2.default.createElement(_reactstrap.ButtonGroup,{size:'sm',style:{padding:'0.2rem 0'}},this.renderActions(f)),b&&_react2.default.createElement('p',{className:'text-success description animated fadeIn'},b),c&&_react2.default.createElement('p',{className:'text-danger description animated fadeIn'},c)))}}]),b}(_react.PureComponent);NotificationListItem.propTypes={item:_propTypes2.default.object.isRequired,priorityClasses:_propTypes2.default.instanceOf(Map).isRequired,truncateTextLength:_propTypes2.default.number.isRequired};var NotificationListItemPreview=exports.NotificationListItemPreview=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.handleAction=function(a,b){var d=a(b);d&&d.isSuccess?(c.setState({successMessage:d&&d.message?d.message:'Done!'}),setTimeout(function(){return c.setState({successMessage:null})},3e3)):(c.setState({errorMessage:d&&d.message?d.message:'Something went wrong...'}),setTimeout(function(){return c.setState({errorMessage:null})},3e3))},c.state={showFullText:!1,successMessage:null,errorMessage:null},c}return _inherits(b,a),_createClass(b,[{key:'truncateText',value:function d(a,b){var c=this.state.showFullText;return a.length>b&&!c?a.substring(0,b)+'...':a}},{key:'renderActions',value:function c(a){var b=this;if(a.type&&a.type.actions)return _react2.default.createElement('div',null,a.type.actions.map(function(c){return _react2.default.createElement(_reactstrap.Button,{key:c.icon,color:c.color,onClick:function d(){return b.handleAction(c.func,a)},style:{padding:'0.1rem'}},_react2.default.createElement('i',{className:c.icon}),' ',c.name)}))}},{key:'render',value:function g(){var a=this.state,b=a.successMessage,c=a.errorMessage,d=this.props,e=d.item,f=d.truncateTextLength;return _react2.default.createElement('div',{className:'message',style:{borderBottom:'1px solid #c2cfd6'}},_react2.default.createElement(_reactstrap.DropdownItem,{href:'#',style:{border:'none'}},_react2.default.createElement('div',null,_react2.default.createElement('div',null,_react2.default.createElement('small',{className:'text-muted'},e.sender.firstName,' ',e.sender.lastName),_react2.default.createElement('small',{className:'text-muted float-right mt-1'},e.date.displayDate)),_react2.default.createElement('div',{className:'text-truncate font-weight-bold'},_react2.default.createElement('span',{className:e.type.icon}),' ',e.title),_react2.default.createElement('div',{className:'small text-muted text-truncate'},e.text.length>f?this.truncateText(e.text,f):e.text)),b&&_react2.default.createElement('p',{className:'text-success description animated fadeIn'},b),c&&_react2.default.createElement('p',{className:'text-danger description animated fadeIn'},c)),_react2.default.createElement(_reactstrap.ButtonGroup,{size:'sm',style:{padding:'0.1rem 0.5rem'},className:'message'},this.renderActions(e)))}}]),b}(_react.PureComponent);NotificationListItemPreview.propTypes={item:_propTypes2.default.object.isRequired,truncateTextLength:_propTypes2.default.number.isRequired};